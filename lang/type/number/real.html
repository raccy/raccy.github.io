<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <meta name=viewport content="width=device-width, initial-scale=1"> <title>実数型</title><link href="/stylesheets/all.css" rel=stylesheet /><link href="/stylesheets/highlight.css" rel=stylesheet /><link href="/stylesheets/lang-navi.css" rel=stylesheet /><script src="/javascripts/all.js"></script><script src="/javascripts/highlight.pack.js"></script><script src="/javascripts/html5shiv.js"></script><!--[endif]--> </head> <body class="lang lang_type lang_type_number lang_type_number_real"> <header> <div class=container> <nav class="navbar navbar-default" role=navigation> <div class=container-fluid> <div class=navbar-header> <a class=navbar-brand href="#">自家用プログラム言語大全</a> </div> </div> </nav> </div> </header> <div class=container> <div class=row> <div class=col-md-3> <nav class=lang-navi-sidebar> <h4> 目次 </h4> <ul class="nav nav-pills nav-stacked" role=tablist> <li><a href="/lang/">自家用プログラム言語大全</a><ul class="nav nav-pills nav-stacked" role=tablist><li><a href="/lang/base/">言語の基礎</a><ul class="nav nav-pills nav-stacked" role=tablist><li><a href="/lang/base/hello.html">こんにちは、世界！</a></li></ul></li><li><a href="/lang/logical.html">論理学？</a></li><li><a href="/lang/operator/">演算子</a></li><li><a href="/lang/type/">型</a><ul class="nav nav-pills nav-stacked" role=tablist><li><a href="/lang/type/number/">数値型</a><ul class="nav nav-pills nav-stacked" role=tablist><li><a href="/lang/type/number/integer.html">整数型</a></li><li class=active><a href="/lang/type/number/real.html">実数型</a></li><li><a href="/lang/type/number/complex.html">複素数型</a></li><li><a href="/lang/type/number/ambiguous.html">曖昧な数値型</a></li></ul></li></ul></li></ul></li> </ul> </nav> </div> <div class=col-md-9> <ol class=breadcrumb> <li> <a href="/lang/">自家用プログラム言語大全</a> </li> <li> <a href="/lang/type/">型</a> </li> <li> <a href="/lang/type/number/">数値型</a> </li> <li class=active> 実数型 </li> </ol><h1> 実数型 </h1><main><h2> 概要 </h2> <p> 数の概念には0.1や1/2(2分の1)といった整数では表せないものがあります。ほとんどの場合は小数や分数で表現できますが、円周率やネイピア数、√2といった無理数を表すことはできません。コンピュータではメモリは有限のため、精度を決めて、結果を丸める必要が出てきます。そこで問題となるのは、どのよう形式で値をメモリに保存し、どこまで精度を持たせるかになります。 </p> <p> 大きく分けると実装は小数点数型と有理数型に分かれます。通常の小数点数型は小数部と指数部についてそれぞれメモリで保存する領域決め、計算する方法です。指数部によって小数点の位置が変わるため浮動小数点数と呼ばれます。浮動小数点数で表現できる大きさは指数部に依存し、精度は小数部に依存します。 </p> <p> コンピュータは2進数のほうが計算しやすいため、基数が2の場合がほとんどです。しかし、その方法では単純な小数の足し算ですら、精度の問題で丸め込みが発生するため、別途基数を10にした10進数で計算する型が用意されている場合があります。また、小数点数以下の精度が定まっている計算を想定して、小数点数以下の精度を固定する型もあります。特に通貨計算のために、10を基数として小数点数以下は固定した型(通貨型とも呼ばれます)を用意している言語もあります。 </p> <p> 有理数型は少し特殊です。数学の分数と同じように、分子と分母を別々に保存しています。有理数型を使用する利点は、計算結果が有理数となる演算では精度が全く落ちないと言うことです。実際の数は全て分数表記できますので、最も正確に演算できます。 </p> <p> 最後に無理数型ですが、有限なメモリ空間では表現不可能なため、存在しません。ただし、精度を引数で渡すと、その精度での円周率やネイピア数を返すという関数が用意されている場合があります。ある意味無理数型と言ってもいいのでは無いかと思います。 </p> <h2> 実数型の一覧 </h2> <h3> 浮動小数点数の一覧 </h3><div class=table-responsive><table class="table table-bordered table-condensed small"><thead><tr><th>言語</th><th>型/クラス</th><th>別名</th><th>継承</th><th>基数</th><th>サイズ(bit数)</th><th></th><th>精度(bit数)</th><th>最大表現数</th><th>最小表現数</th><th>無限値</th><th>非数値</th><th></th><th>リテラル</th><th>ライブラリ</th><th>説明</th></tr></thead><tbody><tr><td rowspan=7>IEEE754</td><td class=text-nowrap>binary16</td><td class=text-nowrap>半精度</td><td class=text-nowrap></td><td class=text-nowrap>2</td><td class=text-nowrap>16</td><td class=text-nowrap>5</td><td class=text-nowrap>10</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td></td></tr><tr><td class=text-nowrap>binary32</td><td class=text-nowrap>単精度</td><td class=text-nowrap></td><td class=text-nowrap>2</td><td class=text-nowrap>32</td><td class=text-nowrap>8</td><td class=text-nowrap>23</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td></td></tr><tr><td class=text-nowrap>binary64</td><td class=text-nowrap>倍精度</td><td class=text-nowrap></td><td class=text-nowrap>2</td><td class=text-nowrap>64</td><td class=text-nowrap>11</td><td class=text-nowrap>52</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td></td></tr><tr><td class=text-nowrap>binary128</td><td class=text-nowrap>四倍精度</td><td class=text-nowrap></td><td class=text-nowrap>2</td><td class=text-nowrap>128</td><td class=text-nowrap>15</td><td class=text-nowrap>112</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td></td></tr><tr><td class=text-nowrap>decimal32</td><td class=text-nowrap>十進単精度</td><td class=text-nowrap></td><td class=text-nowrap>10</td><td class=text-nowrap>32</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td></td></tr><tr><td class=text-nowrap>decimal64</td><td class=text-nowrap>十進倍精度</td><td class=text-nowrap></td><td class=text-nowrap>10</td><td class=text-nowrap>64</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td></td></tr><tr><td class=text-nowrap>decimal128</td><td class=text-nowrap>十進四倍精度</td><td class=text-nowrap></td><td class=text-nowrap>10</td><td class=text-nowrap>128</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td></td></tr><tr><td rowspan=3>C</td><td class=text-nowrap>float</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap>未定義、通常は32</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap>1E+37</td><td class=text-nowrap>1E-5</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td>IEEE754 binary16 単精度</td></tr><tr><td class=text-nowrap>double</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap>未定義、通常は64</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap>1E+37</td><td class=text-nowrap>1E-9</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td></td></tr><tr><td class=text-nowrap>long double</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap>未定義、通常は128</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap>1E+37</td><td class=text-nowrap>1E-9</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td></td></tr><tr><td rowspan=1>Python</td><td class=text-nowrap>decimal</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap>10</td><td class=text-nowrap>精度を指定可能</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap>Infinity</td><td class=text-nowrap>-Infinity</td><td class=text-nowrap></td><td class=text-nowrap>NaN</td><td class=text-nowrap>×</td><td class=text-nowrap></td><td class=text-nowrap></td><td></td></tr><tr><td rowspan=1>Ruby</td><td class=text-nowrap>Float</td><td class=text-nowrap></td><td class=text-nowrap>Numeric<br>Object<br>BasicObject</td><td colspan=3>実装の<code>dobule</code>に依存。</td><td class=text-nowrap></td><td colspan=2>実装の<code>dobule</code>に依存。</td><td class=text-nowrap></td><td colspan=3>実装の<code>dobule</code>に依存。</td><td class=text-nowrap></td><td>実装は<code>double</code>を使用しているため、そのまま<code>double</code>の範囲に依存します。<br>CRubyでは、<code>sizeof(void *) >= sizeof(dobule)</code>の環境でのみFlonumという特殊な形式で実装される場合があります。内部で2bit分削ったビット列を<code>VALUE</code>にそのまま保存することで、この2bit分を含まない範囲の浮動小数点数については<code>dobule</code>としてそのまま扱うことができ、処理を高速化しています。範囲外になる場合は自動的に通常のFloatになります。プログラマーからは(オブジェクトのIDがいつも同じになること以外に)Floatと区別はできません。</td></tr></tbody></table></div> <script>
        //<![CDATA[
        $(function(){
          options = {
            template: '<div class="popover small" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',
            trigger: 'hover focus',
            placement: 'top',
            container: 'body'}
          $('[data-toggle=popover]').popover(options);
        });
        //]]>
        </script> <h3> 固定小数点数の一覧 </h3> <div class=table-responsive><table class="table table-bordered table-condensed small"><thead><tr><th>言語</th><th>型/クラス</th><th>別名</th><th>継承</th><th>基数</th><th>サイズ(bit数)</th><th></th><th>精度(bit数)</th><th>最大表現数</th><th>最小表現数</th><th>無限値</th><th>非数値</th><th></th><th>リテラル</th><th>ライブラリ</th><th>説明</th></tr></thead><tbody></tbody></table></div> <script>
        //<![CDATA[
        $(function(){
          options = {
            template: '<div class="popover small" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',
            trigger: 'hover focus',
            placement: 'top',
            container: 'body'}
          $('[data-toggle=popover]').popover(options);
        });
        //]]>
        </script> <h3> 有理数型の一覧 </h3> <div class=table-responsive><table class="table table-bordered table-condensed small"><thead><tr><th>言語</th><th>型/クラス</th><th>別名</th><th>継承</th><th>基数</th><th>サイズ(bit数)</th><th></th><th>精度(bit数)</th><th>最大表現数</th><th>最小表現数</th><th>無限値</th><th>非数値</th><th></th><th>リテラル</th><th>ライブラリ</th><th>説明</th></tr></thead><tbody><tr><td rowspan=1>Ruby</td><td class=text-nowrap>Rational</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap>多倍長</td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td class=text-nowrap></td><td>分子と分母はInteger(FixNumとBigNum)として保存しているため、メモリが許す限りどんな大きな値も処理できます。計算結果が有理数にならないときは自動的にFloatになります。</td></tr></tbody></table></div> <script>
        //<![CDATA[
        $(function(){
          options = {
            template: '<div class="popover small" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',
            trigger: 'hover focus',
            placement: 'top',
            container: 'body'}
          $('[data-toggle=popover]').popover(options);
        });
        //]]>
        </script> <h3> 無理数型の一覧 </h3> <p> 存在しません。 </p> <h2> 計算速度 </h2> <p> ほとんどの実装で、浮動小数点数はIEEE 754の2進数(基数2)を採用しています。現在あるほとんどのCPUはIEEE 754 倍精度についてコア部分とは別に演算ユニットを持ち、高速に計算することができます。10進数(基数10)の実装であるIEEE 854もIEEE 754に吸収され、同じくCPUには専用の算ユニットがあります。速度については2進数と10進数どちらが速いかは資料を見つけられなかったため、わかりませんでした。通貨計算などの、10進数での表記が重要になる場合を除き、一般の計算には2進数の浮動小数点数を使用しているようです。 </p> <p> 有理数型の計算は遅く、多くのメモリが必要になります。速度を期待してはいけません。 </p></main> <hr> <p> 間違いを見つけた場合や、ご意見・ご指摘は<a href="https://github.com/raccy/raccy.github.io.middleman/issues">GitHubレポジトリIssues</a>へお願いします。 </p> </div> </div> </div> <footer> <hr> <div class=container> <p><a href="/plain/LICENSE.html"> MIT / CC-BY © 2014-2015 raccy</a> </p> </div> </footer> </body> </html>